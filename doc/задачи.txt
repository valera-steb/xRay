есть:
    .карта ходов.
        .в ходах есть проходы к некорректным ходам.
        .нужно убрать ходы к лишним...
    .набор пометок.

вывод:
    .достаточно собрать пометки и карту - получить ещё одну карту.
    .нет - нужно отследить начиная с конца карты пути:
        .если в точку приходят из как минимум 2-х разных позиций
            .пометка неопределённо.
        .только из одной - от этой одной.

    .превратить в:
        {
            '00x000000': [{t:_num_, m:'_mark_'}, ...]
        }
    + оставить - ид к ключу_состоянию:
        {
            1: '00x000000',
            2: '00xy00000'
        }